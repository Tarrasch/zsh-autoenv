language: generic
sudo: false
env:
  - TEST_ZSH=4.3.17
  - TEST_ZSH=5.0.8
  - TEST_ZSH=5.1.1
  - TEST_ZSH=5.2
  - TEST_ZSH=5.3.1

install:
  - |
    if [ "$TEST_ZSH" = 4.3.17 ]; then
      sudo apt-get install zsh
      if [ "$(zsh --version)" != "zsh 4.3.17 (x86_64-unknown-linux-gnu)" ]; then
        echo "Unexpected Zsh version: $(zsh --version)"
        exit 1
      fi
    else
      (curl -SL https://downloads.sourceforge.net/project/zsh/zsh/$TEST_ZSH/zsh-$TEST_ZSH.tar.xz | tar -xf -
      cd zsh-$TEST_ZSH
      ./configure && sudo make && sudo make install)
    fi
  - pip install --user cram
  - export SHELL=zsh
script:
  - zsh --version
  - which zsh
  - make test_full
