language: generic
sudo: false
env:
  - ZSH=4.3.17
  - ZSH=5.0.8
  - ZSH=5.1.1
  - ZSH=5.2
  - ZSH=5.3.1

install:
  - |
    if [ "$ZSH" = 4.3.17 ]; then
      sudo apt-get install zsh
      if [ "$(zsh --version)" != "zsh 4.3.17 (x86_64-unknown-linux-gnu)" ]; then
        echo "Unexpected Zsh version: $(zsh --version)"
        exit 1
      fi
    else
      (wget http://downloads.sourceforge.net/project/zsh/zsh/$ZSH/zsh-$ZSH.tar.bz2
      tar xf zsh-$ZSH.tar.bz2
      cd zsh-$ZSH
      ./configure && sudo make && sudo make install)
    fi
  - pip install --user cram
  - export SHELL=zsh
script:
  - zsh --version
  - which zsh
  - make test
